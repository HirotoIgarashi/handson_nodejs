'use stricct';function cov_1rolrcuzw(){var path="/home/hiroto/git/handson_nodejs/todo-data-storage/file-system/index.js";var hash="c3759a3a93cbd7fd01008579d69069cb76293b44";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/hiroto/git/handson_nodejs/todo-data-storage/file-system/index.js",statementMap:{"0":{start:{line:3,column:20},end:{line:3,column:35}},"1":{start:{line:4,column:49},end:{line:4,column:71}},"2":{start:{line:6,column:0},end:{line:16,column:2}},"3":{start:{line:8,column:16},end:{line:9,column:46}},"4":{start:{line:9,column:20},end:{line:9,column:45}},"5":{start:{line:11,column:2},end:{line:15,column:4}},"6":{start:{line:13,column:6},end:{line:13,column:63}},"7":{start:{line:18,column:0},end:{line:19,column:64}},"8":{start:{line:18,column:40},end:{line:19,column:64}},"9":{start:{line:19,column:15},end:{line:19,column:63}},"10":{start:{line:19,column:34},end:{line:19,column:62}},"11":{start:{line:21,column:0},end:{line:22,column:65}},"12":{start:{line:22,column:2},end:{line:22,column:65}},"13":{start:{line:24,column:0},end:{line:38,column:2}},"14":{start:{line:25,column:19},end:{line:25,column:44}},"15":{start:{line:27,column:2},end:{line:37,column:4}},"16":{start:{line:29,column:19},end:{line:32,column:7}},"17":{start:{line:33,column:6},end:{line:33,column:72}},"18":{start:{line:33,column:66},end:{line:33,column:70}},"19":{start:{line:36,column:11},end:{line:36,column:61}},"20":{start:{line:40,column:0},end:{line:45,column:3}},"21":{start:{line:40,column:23},end:{line:45,column:3}},"22":{start:{line:42,column:10},end:{line:42,column:12}},"23":{start:{line:44,column:11},end:{line:44,column:61}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:19},end:{line:6,column:20}},loc:{start:{line:6,column:31},end:{line:16,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:12},end:{line:9,column:13}},loc:{start:{line:9,column:20},end:{line:9,column:45}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:12,column:14},end:{line:12,column:15}},loc:{start:{line:13,column:6},end:{line:13,column:63}},line:13},"3":{name:"(anonymous_3)",decl:{start:{line:18,column:27},end:{line:18,column:28}},loc:{start:{line:18,column:40},end:{line:19,column:64}},line:18},"4":{name:"(anonymous_4)",decl:{start:{line:19,column:8},end:{line:19,column:9}},loc:{start:{line:19,column:15},end:{line:19,column:63}},line:19},"5":{name:"(anonymous_5)",decl:{start:{line:19,column:26},end:{line:19,column:27}},loc:{start:{line:19,column:34},end:{line:19,column:62}},line:19},"6":{name:"(anonymous_6)",decl:{start:{line:21,column:17},end:{line:21,column:18}},loc:{start:{line:22,column:2},end:{line:22,column:65}},line:22},"7":{name:"(anonymous_7)",decl:{start:{line:24,column:17},end:{line:24,column:18}},loc:{start:{line:24,column:39},end:{line:38,column:1}},line:24},"8":{name:"(anonymous_8)",decl:{start:{line:28,column:4},end:{line:28,column:5}},loc:{start:{line:28,column:15},end:{line:34,column:5}},line:28},"9":{name:"(anonymous_9)",decl:{start:{line:33,column:60},end:{line:33,column:61}},loc:{start:{line:33,column:66},end:{line:33,column:70}},line:33},"10":{name:"(anonymous_10)",decl:{start:{line:36,column:4},end:{line:36,column:5}},loc:{start:{line:36,column:11},end:{line:36,column:61}},line:36},"11":{name:"(anonymous_11)",decl:{start:{line:40,column:17},end:{line:40,column:18}},loc:{start:{line:40,column:23},end:{line:45,column:3}},line:40},"12":{name:"(anonymous_12)",decl:{start:{line:42,column:4},end:{line:42,column:5}},loc:{start:{line:42,column:10},end:{line:42,column:12}},line:42},"13":{name:"(anonymous_13)",decl:{start:{line:44,column:4},end:{line:44,column:5}},loc:{start:{line:44,column:11},end:{line:44,column:61}},line:44}},branchMap:{"0":{loc:{start:{line:36,column:11},end:{line:36,column:61}},type:"cond-expr",locations:[{start:{line:36,column:35},end:{line:36,column:39}},{start:{line:36,column:42},end:{line:36,column:61}}],line:36},"1":{loc:{start:{line:44,column:11},end:{line:44,column:61}},type:"cond-expr",locations:[{start:{line:44,column:35},end:{line:44,column:39}},{start:{line:44,column:42},end:{line:44,column:61}}],line:44}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"c3759a3a93cbd7fd01008579d69069cb76293b44"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1rolrcuzw=function(){return actualCoverage;};}return actualCoverage;}cov_1rolrcuzw();const{extname}=(cov_1rolrcuzw().s[0]++,require('path'));const{readdir,readFile,writeFile,unlink}=(cov_1rolrcuzw().s[1]++,require('fs').promises);cov_1rolrcuzw().s[2]++;exports.fetchAll=async()=>{cov_1rolrcuzw().f[0]++;// 同一ディレクトリ内に存在するJSONファイルをすべて取得
const files=(cov_1rolrcuzw().s[3]++,(await readdir(__dirname)).filter(file=>{cov_1rolrcuzw().f[1]++;cov_1rolrcuzw().s[4]++;return extname(file)==='.json';}));cov_1rolrcuzw().s[5]++;return Promise.all(files.map(file=>{cov_1rolrcuzw().f[2]++;cov_1rolrcuzw().s[6]++;return readFile(`${__dirname}/${file}`,'utf8').then(JSON.parse);}));};cov_1rolrcuzw().s[7]++;exports.fetchByCompleted=completed=>{cov_1rolrcuzw().f[3]++;cov_1rolrcuzw().s[8]++;return exports.fetchAll().then(all=>{cov_1rolrcuzw().f[4]++;cov_1rolrcuzw().s[9]++;return all.filter(todo=>{cov_1rolrcuzw().f[5]++;cov_1rolrcuzw().s[10]++;return todo.completed===completed;});});};cov_1rolrcuzw().s[11]++;exports.create=todo=>{cov_1rolrcuzw().f[6]++;cov_1rolrcuzw().s[12]++;return writeFile(`${__dirname}/${todo.id}.json`,JSON.stringify(todo));};cov_1rolrcuzw().s[13]++;exports.update=async(id,update)=>{cov_1rolrcuzw().f[7]++;const fileName=(cov_1rolrcuzw().s[14]++,`${__dirname}/${id}.json`);cov_1rolrcuzw().s[15]++;return readFile(fileName,'utf8').then(content=>{cov_1rolrcuzw().f[8]++;const todo=(cov_1rolrcuzw().s[16]++,{...JSON.parse(content),...update});cov_1rolrcuzw().s[17]++;return writeFile(fileName,JSON.stringify(todo)).then(()=>{cov_1rolrcuzw().f[9]++;cov_1rolrcuzw().s[18]++;return todo;});},// ファイルが存在しない場合はnullを返し、それ以外はそのままエラーにする
err=>{cov_1rolrcuzw().f[10]++;cov_1rolrcuzw().s[19]++;return err.code==='ENOENT'?(cov_1rolrcuzw().b[0][0]++,null):(cov_1rolrcuzw().b[0][1]++,Promise.reject(err));});};cov_1rolrcuzw().s[20]++;exports.remove=id=>{cov_1rolrcuzw().f[11]++;cov_1rolrcuzw().s[21]++;return unlink(`${__dirname}/${id}.json`).then(()=>{cov_1rolrcuzw().f[12]++;cov_1rolrcuzw().s[22]++;return id;},// ファイルが存在しない場合はnullを返し、それ以外はそのままエラーにする
err=>{cov_1rolrcuzw().f[13]++;cov_1rolrcuzw().s[23]++;return err.code==='ENOENT'?(cov_1rolrcuzw().b[1][0]++,null):(cov_1rolrcuzw().b[1][1]++,Promise.reject(err));});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImV4dG5hbWUiLCJyZXF1aXJlIiwicmVhZGRpciIsInJlYWRGaWxlIiwid3JpdGVGaWxlIiwidW5saW5rIiwicHJvbWlzZXMiLCJleHBvcnRzIiwiZmV0Y2hBbGwiLCJmaWxlcyIsIl9fZGlybmFtZSIsImZpbHRlciIsImZpbGUiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwidGhlbiIsIkpTT04iLCJwYXJzZSIsImZldGNoQnlDb21wbGV0ZWQiLCJjb21wbGV0ZWQiLCJ0b2RvIiwiY3JlYXRlIiwiaWQiLCJzdHJpbmdpZnkiLCJ1cGRhdGUiLCJmaWxlTmFtZSIsImNvbnRlbnQiLCJlcnIiLCJjb2RlIiwicmVqZWN0IiwicmVtb3ZlIl0sIm1hcHBpbmdzIjoiQUFBQSxjLGdsSkFlWTt5RkFiWixLQUFNLENBQUVBLE9BQUYsMEJBQWNDLE9BQU8sQ0FBQyxNQUFELENBQXJCLENBQU4sQ0FDQSxLQUFNLENBQUVDLE9BQUYsQ0FBV0MsUUFBWCxDQUFxQkMsU0FBckIsQ0FBZ0NDLE1BQWhDLDBCQUEyQ0osT0FBTyxDQUFDLElBQUQsQ0FBUCxDQUFjSyxRQUF6RCxDQUFOLEMsdUJBRUFDLE9BQU8sQ0FBQ0MsUUFBUixDQUFtQixTQUFZLHdCQUM3QjtBQUNBLEtBQU1DLENBQUFBLEtBQUsseUJBQUcsQ0FBQyxLQUFNUCxDQUFBQSxPQUFPLENBQUNRLFNBQUQsQ0FBZCxFQUNYQyxNQURXLENBQ0pDLElBQUksRUFBSSxxREFBQVosQ0FBQUEsT0FBTyxDQUFDWSxJQUFELENBQVAsR0FBa0IsT0FBbEIsQ0FBeUIsQ0FEN0IsQ0FBSCxDQUFYLENBRjZCLHVCQUs3QixNQUFPQyxDQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FDTEwsS0FBSyxDQUFDTSxHQUFOLENBQVVILElBQUksRUFDWixxREFBQVQsQ0FBQUEsUUFBUSxDQUFFLEdBQUVPLFNBQVUsSUFBR0UsSUFBSyxFQUF0QixDQUF5QixNQUF6QixDQUFSLENBQXlDSSxJQUF6QyxDQUE4Q0MsSUFBSSxDQUFDQyxLQUFuRCxFQUF5RCxDQUQzRCxDQURLLENBQVAsQ0FLRCxDQVZELEMsdUJBWUFYLE9BQU8sQ0FBQ1ksZ0JBQVIsQ0FBMkJDLFNBQVMsRUFBSSxxREFBQWIsQ0FBQUEsT0FBTyxDQUFDQyxRQUFSLEdBQ3JDUSxJQURxQyxDQUNoQ0YsR0FBRyxFQUFJLHFEQUFBQSxDQUFBQSxHQUFHLENBQUNILE1BQUosQ0FBV1UsSUFBSSxFQUFJLHNEQUFBQSxDQUFBQSxJQUFJLENBQUNELFNBQUwsR0FBbUJBLFNBQW5CLENBQTRCLENBQS9DLEVBQWdELENBRHZCLEVBQ3dCLENBRGhFLEMsd0JBR0FiLE9BQU8sQ0FBQ2UsTUFBUixDQUFpQkQsSUFBSSxFQUNuQixzREFBQWpCLENBQUFBLFNBQVMsQ0FBRSxHQUFFTSxTQUFVLElBQUdXLElBQUksQ0FBQ0UsRUFBRyxPQUF6QixDQUFpQ04sSUFBSSxDQUFDTyxTQUFMLENBQWVILElBQWYsQ0FBakMsQ0FBVCxDQUErRCxDQURqRSxDLHdCQUdBZCxPQUFPLENBQUNrQixNQUFSLENBQWlCLE1BQU9GLEVBQVAsQ0FBV0UsTUFBWCxHQUFzQix3QkFDckMsS0FBTUMsQ0FBQUEsUUFBUSwwQkFBSSxHQUFFaEIsU0FBVSxJQUFHYSxFQUFHLE9BQXRCLENBQWQsQ0FEcUMsd0JBR3JDLE1BQU9wQixDQUFBQSxRQUFRLENBQUN1QixRQUFELENBQVcsTUFBWCxDQUFSLENBQTJCVixJQUEzQixDQUNMVyxPQUFPLEVBQUksd0JBQ1QsS0FBTU4sQ0FBQUEsSUFBSSwwQkFBRyxDQUNYLEdBQUdKLElBQUksQ0FBQ0MsS0FBTCxDQUFXUyxPQUFYLENBRFEsQ0FFWCxHQUFHRixNQUZRLENBQUgsQ0FBVixDQURTLHdCQUtULE1BQU9yQixDQUFBQSxTQUFTLENBQUNzQixRQUFELENBQVdULElBQUksQ0FBQ08sU0FBTCxDQUFlSCxJQUFmLENBQVgsQ0FBVCxDQUEwQ0wsSUFBMUMsQ0FBK0MsSUFBTUssc0RBQUFBLENBQUFBLElBQUksRUFBekQsQ0FBUCxDQUNELENBUEksQ0FRTDtBQUNBTyxHQUFHLEVBQUksdURBQUFBLENBQUFBLEdBQUcsQ0FBQ0MsSUFBSixHQUFhLFFBQWIsNEJBQXdCLElBQXhCLDZCQUErQmhCLE9BQU8sQ0FBQ2lCLE1BQVIsQ0FBZUYsR0FBZixDQUEvQixFQUFrRCxDQVRwRCxDQUFQLENBV0QsQ0FkRCxDLHdCQWdCQXJCLE9BQU8sQ0FBQ3dCLE1BQVIsQ0FBaUJSLEVBQUUsRUFBSSx1REFBQWxCLENBQUFBLE1BQU0sQ0FBRSxHQUFFSyxTQUFVLElBQUdhLEVBQUcsT0FBcEIsQ0FBTixDQUNwQlAsSUFEb0IsQ0FFbkIsSUFBTU8sdURBQUFBLENBQUFBLEVBQUUsRUFGVyxDQUduQjtBQUNBSyxHQUFHLEVBQUksdURBQUFBLENBQUFBLEdBQUcsQ0FBQ0MsSUFBSixHQUFhLFFBQWIsNEJBQXdCLElBQXhCLDZCQUErQmhCLE9BQU8sQ0FBQ2lCLE1BQVIsQ0FBZUYsR0FBZixDQUEvQixFQUFrRCxDQUp0QyxFQUtwQixDQUxIIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY2N0JztcblxuY29uc3QgeyBleHRuYW1lIH0gPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB7IHJlYWRkaXIsIHJlYWRGaWxlLCB3cml0ZUZpbGUsIHVubGluayB9ID0gcmVxdWlyZSgnZnMnKS5wcm9taXNlcztcblxuZXhwb3J0cy5mZXRjaEFsbCA9IGFzeW5jICgpID0+IHtcbiAgLy8g5ZCM5LiA44OH44Kj44Os44Kv44OI44Oq5YaF44Gr5a2Y5Zyo44GZ44KLSlNPTuODleOCoeOCpOODq+OCkuOBmeOBueOBpuWPluW+l1xuICBjb25zdCBmaWxlcyA9IChhd2FpdCByZWFkZGlyKF9fZGlybmFtZSkpXG4gICAgLmZpbHRlcihmaWxlID0+IGV4dG5hbWUoZmlsZSkgPT09ICcuanNvbicpXG5cbiAgcmV0dXJuIFByb21pc2UuYWxsKFxuICAgIGZpbGVzLm1hcChmaWxlID0+XG4gICAgICByZWFkRmlsZShgJHtfX2Rpcm5hbWV9LyR7ZmlsZX1gLCAndXRmOCcpLnRoZW4oSlNPTi5wYXJzZSlcbiAgICApXG4gICk7XG59O1xuXG5leHBvcnRzLmZldGNoQnlDb21wbGV0ZWQgPSBjb21wbGV0ZWQgPT4gZXhwb3J0cy5mZXRjaEFsbCgpXG4gIC50aGVuKGFsbCA9PiBhbGwuZmlsdGVyKHRvZG8gPT4gdG9kby5jb21wbGV0ZWQgPT09IGNvbXBsZXRlZCkpXG5cbmV4cG9ydHMuY3JlYXRlID0gdG9kbyA9PlxuICB3cml0ZUZpbGUoYCR7X19kaXJuYW1lfS8ke3RvZG8uaWR9Lmpzb25gLCBKU09OLnN0cmluZ2lmeSh0b2RvKSlcblxuZXhwb3J0cy51cGRhdGUgPSBhc3luYyAoaWQsIHVwZGF0ZSkgPT4ge1xuICBjb25zdCBmaWxlTmFtZSA9IGAke19fZGlybmFtZX0vJHtpZH0uanNvbmBcblxuICByZXR1cm4gcmVhZEZpbGUoZmlsZU5hbWUsICd1dGY4JykudGhlbihcbiAgICBjb250ZW50ID0+IHtcbiAgICAgIGNvbnN0IHRvZG8gPSB7XG4gICAgICAgIC4uLkpTT04ucGFyc2UoY29udGVudCksXG4gICAgICAgIC4uLnVwZGF0ZVxuICAgICAgfVxuICAgICAgcmV0dXJuIHdyaXRlRmlsZShmaWxlTmFtZSwgSlNPTi5zdHJpbmdpZnkodG9kbykpLnRoZW4oKCkgPT4gdG9kbyk7XG4gICAgfSxcbiAgICAvLyDjg5XjgqHjgqTjg6vjgYzlrZjlnKjjgZfjgarjgYTloLTlkIjjga9udWxs44KS6L+U44GX44CB44Gd44KM5Lul5aSW44Gv44Gd44Gu44G+44G+44Ko44Op44O844Gr44GZ44KLXG4gICAgZXJyID0+IGVyci5jb2RlID09PSAnRU5PRU5UJyA/IG51bGwgOiBQcm9taXNlLnJlamVjdChlcnIpXG4gICk7XG59O1xuXG5leHBvcnRzLnJlbW92ZSA9IGlkID0+IHVubGluayhgJHtfX2Rpcm5hbWV9LyR7aWR9Lmpzb25gKVxuICAudGhlbihcbiAgICAoKSA9PiBpZCxcbiAgICAvLyDjg5XjgqHjgqTjg6vjgYzlrZjlnKjjgZfjgarjgYTloLTlkIjjga9udWxs44KS6L+U44GX44CB44Gd44KM5Lul5aSW44Gv44Gd44Gu44G+44G+44Ko44Op44O844Gr44GZ44KLXG4gICAgZXJyID0+IGVyci5jb2RlID09PSAnRU5PRU5UJyA/IG51bGwgOiBQcm9taXNlLnJlamVjdChlcnIpXG4gIClcbiJdfQ==