'use strict';function cov_1dqamey07w(){var path="/home/hiroto/git/handson_nodejs/todo-data-storage/sqlite/index.js";var hash="4be04ef0d538c425ebd29c44400c5567e26dd80f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/hiroto/git/handson_nodejs/todo-data-storage/sqlite/index.js",statementMap:{"0":{start:{line:3,column:22},end:{line:3,column:37}},"1":{start:{line:4,column:17},end:{line:4,column:32}},"2":{start:{line:5,column:16},end:{line:8,column:32}},"3":{start:{line:11,column:11},end:{line:11,column:58}},"4":{start:{line:14,column:14},end:{line:14,column:40}},"5":{start:{line:15,column:14},end:{line:24,column:1}},"6":{start:{line:16,column:2},end:{line:23,column:3}},"7":{start:{line:17,column:4},end:{line:22,column:6}},"8":{start:{line:20,column:8},end:{line:20,column:41}},"9":{start:{line:26,column:14},end:{line:26,column:40}},"10":{start:{line:28,column:0},end:{line:36,column:2}},"11":{start:{line:34,column:2},end:{line:34,column:21}},"12":{start:{line:35,column:2},end:{line:35,column:18}},"13":{start:{line:40,column:2},end:{line:40,column:48}},"14":{start:{line:43,column:0},end:{line:44,column:64}},"15":{start:{line:44,column:2},end:{line:44,column:63}},"16":{start:{line:44,column:43},end:{line:44,column:62}},"17":{start:{line:46,column:0},end:{line:48,column:39}},"18":{start:{line:47,column:2},end:{line:48,column:38}},"19":{start:{line:48,column:18},end:{line:48,column:37}},"20":{start:{line:50,column:0},end:{line:57,column:1}},"21":{start:{line:51,column:2},end:{line:56,column:3}},"22":{start:{line:59,column:0},end:{line:75,column:2}},"23":{start:{line:60,column:21},end:{line:60,column:23}},"24":{start:{line:61,column:17},end:{line:61,column:19}},"25":{start:{line:63,column:2},end:{line:68,column:3}},"26":{start:{line:64,column:4},end:{line:67,column:5}},"27":{start:{line:65,column:6},end:{line:65,column:39}},"28":{start:{line:66,column:6},end:{line:66,column:34}},"29":{start:{line:69,column:2},end:{line:69,column:18}},"30":{start:{line:70,column:2},end:{line:74,column:3}},"31":{start:{line:71,column:27},end:{line:73,column:12}},"32":{start:{line:77,column:0},end:{line:78,column:52}},"33":{start:{line:77,column:23},end:{line:78,column:51}},"34":{start:{line:78,column:25},end:{line:78,column:50}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:15,column:14},end:{line:15,column:15}},loc:{start:{line:15,column:25},end:{line:24,column:1}},line:15},"1":{name:"(anonymous_1)",decl:{start:{line:16,column:21},end:{line:16,column:22}},loc:{start:{line:17,column:4},end:{line:22,column:6}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:19,column:6},end:{line:19,column:7}},loc:{start:{line:19,column:20},end:{line:21,column:7}},line:19},"3":{name:"(anonymous_3)",decl:{start:{line:32,column:10},end:{line:32,column:11}},loc:{start:{line:32,column:17},end:{line:36,column:1}},line:32},"4":{name:"rowToTodo",decl:{start:{line:39,column:9},end:{line:39,column:18}},loc:{start:{line:39,column:24},end:{line:41,column:1}},line:39},"5":{name:"(anonymous_5)",decl:{start:{line:43,column:19},end:{line:43,column:20}},loc:{start:{line:44,column:2},end:{line:44,column:63}},line:44},"6":{name:"(anonymous_6)",decl:{start:{line:44,column:35},end:{line:44,column:36}},loc:{start:{line:44,column:43},end:{line:44,column:62}},line:44},"7":{name:"(anonymous_7)",decl:{start:{line:46,column:27},end:{line:46,column:28}},loc:{start:{line:47,column:2},end:{line:48,column:38}},line:47},"8":{name:"(anonymous_8)",decl:{start:{line:48,column:10},end:{line:48,column:11}},loc:{start:{line:48,column:18},end:{line:48,column:37}},line:48},"9":{name:"(anonymous_9)",decl:{start:{line:50,column:17},end:{line:50,column:18}},loc:{start:{line:50,column:31},end:{line:57,column:1}},line:50},"10":{name:"(anonymous_10)",decl:{start:{line:59,column:17},end:{line:59,column:18}},loc:{start:{line:59,column:33},end:{line:75,column:1}},line:59},"11":{name:"(anonymous_11)",decl:{start:{line:71,column:10},end:{line:71,column:11}},loc:{start:{line:71,column:27},end:{line:73,column:12}},line:71},"12":{name:"(anonymous_12)",decl:{start:{line:77,column:17},end:{line:77,column:18}},loc:{start:{line:77,column:23},end:{line:78,column:51}},line:77},"13":{name:"(anonymous_13)",decl:{start:{line:78,column:8},end:{line:78,column:9}},loc:{start:{line:78,column:25},end:{line:78,column:50}},line:78}},branchMap:{"0":{loc:{start:{line:5,column:16},end:{line:8,column:32}},type:"cond-expr",locations:[{start:{line:6,column:4},end:{line:6,column:22}},{start:{line:8,column:4},end:{line:8,column:32}}],line:5},"1":{loc:{start:{line:20,column:8},end:{line:20,column:41}},type:"cond-expr",locations:[{start:{line:20,column:14},end:{line:20,column:25}},{start:{line:20,column:28},end:{line:20,column:41}}],line:20},"2":{loc:{start:{line:64,column:4},end:{line:67,column:5}},type:"if",locations:[{start:{line:64,column:4},end:{line:67,column:5}},{start:{line:64,column:4},end:{line:67,column:5}}],line:64},"3":{loc:{start:{line:71,column:27},end:{line:73,column:12}},type:"cond-expr",locations:[{start:{line:72,column:8},end:{line:72,column:68}},{start:{line:73,column:8},end:{line:73,column:12}}],line:71},"4":{loc:{start:{line:78,column:25},end:{line:78,column:50}},type:"cond-expr",locations:[{start:{line:78,column:41},end:{line:78,column:43}},{start:{line:78,column:46},end:{line:78,column:50}}],line:78}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"4be04ef0d538c425ebd29c44400c5567e26dd80f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1dqamey07w=function(){return actualCoverage;};}return actualCoverage;}cov_1dqamey07w();const{promisify}=(cov_1dqamey07w().s[0]++,require('util'));const{join}=(cov_1dqamey07w().s[1]++,require('path'));const sqlite3=(cov_1dqamey07w().s[2]++,process.env.NODE_ENV==='production'?(cov_1dqamey07w().b[0][0]++,require('sqlite3')// prodduction環境以外は冗長モードを利用
):(cov_1dqamey07w().b[0][1]++,require('sqlite3').verbose()));// todo-data-storage/sqlite/sqliteというファイルにデータベースの状態を保存
const db=(cov_1dqamey07w().s[3]++,new sqlite3.Database(join(__dirname,'sqlite')));// コールパックパターンのメソッドをPromise化
const dbGet=(cov_1dqamey07w().s[4]++,promisify(db.get.bind(db)));cov_1dqamey07w().s[5]++;const dbRun=function(){cov_1dqamey07w().f[0]++;cov_1dqamey07w().s[6]++;return new Promise((resolve,reject)=>{cov_1dqamey07w().f[1]++;cov_1dqamey07w().s[7]++;return db.run.apply(db,[...arguments,function(err){cov_1dqamey07w().f[2]++;cov_1dqamey07w().s[8]++;err?(cov_1dqamey07w().b[1][0]++,reject(err)):(cov_1dqamey07w().b[1][1]++,resolve(this));}]);});};const dbAll=(cov_1dqamey07w().s[9]++,promisify(db.all.bind(db)));cov_1dqamey07w().s[10]++;dbRun(`CREATE TABLE IF NOT EXISTS todo (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  completed BOOLEAN NOT NULL
)`).catch(err=>{cov_1dqamey07w().f[3]++;cov_1dqamey07w().s[11]++;// テープル作成に失敗した場合はアプリケーションを終了
console.error(err);cov_1dqamey07w().s[12]++;process.exit(1);});// データベースのデータをToDoオブジェクトに変換する
function rowToTodo(row){cov_1dqamey07w().f[4]++;cov_1dqamey07w().s[13]++;return{...row,completed:!!row.completed};};cov_1dqamey07w().s[14]++;exports.fetchAll=()=>{cov_1dqamey07w().f[5]++;cov_1dqamey07w().s[15]++;return dbAll(`SELECT * FROM todo`).then(rows=>{cov_1dqamey07w().f[6]++;cov_1dqamey07w().s[16]++;return rows.map(rowToTodo);});};cov_1dqamey07w().s[17]++;exports.fetchByCompleted=completed=>{cov_1dqamey07w().f[7]++;cov_1dqamey07w().s[18]++;return dbAll(`SELECT * FROM todo WHERE completed = ?`,completed).then(rows=>{cov_1dqamey07w().f[8]++;cov_1dqamey07w().s[19]++;return rows.map(rowToTodo);});};cov_1dqamey07w().s[20]++;exports.create=async todo=>{cov_1dqamey07w().f[9]++;cov_1dqamey07w().s[21]++;await dbRun(`INSERT INTO todo VALUES (?, ?, ?)`,todo.id,todo.title,todo.completed);};cov_1dqamey07w().s[22]++;exports.update=(id,update)=>{cov_1dqamey07w().f[10]++;const setColumns=(cov_1dqamey07w().s[23]++,[]);const values=(cov_1dqamey07w().s[24]++,[]);cov_1dqamey07w().s[25]++;for(const column of['title','completed']){cov_1dqamey07w().s[26]++;if(column in update){cov_1dqamey07w().b[2][0]++;cov_1dqamey07w().s[27]++;setColumns.push(`${column} = ?`);cov_1dqamey07w().s[28]++;values.push(update[column]);}else{cov_1dqamey07w().b[2][1]++;}}cov_1dqamey07w().s[29]++;values.push(id);cov_1dqamey07w().s[30]++;return dbRun(`UPDATE todo SET ${setColumns.join()} WHERE id = ?`,values).then(({changes})=>{cov_1dqamey07w().f[11]++;cov_1dqamey07w().s[31]++;return changes===1?(cov_1dqamey07w().b[3][0]++,dbGet(`SELECT * FROM todo WHERE id = ?`,id).then(rowToTodo)):(cov_1dqamey07w().b[3][1]++,null);});};cov_1dqamey07w().s[32]++;exports.remove=id=>{cov_1dqamey07w().f[12]++;cov_1dqamey07w().s[33]++;return dbRun(`DELETE FROM todo WHERE id = ?`,id).then(({changes})=>{cov_1dqamey07w().f[13]++;cov_1dqamey07w().s[34]++;return changes===1?(cov_1dqamey07w().b[4][0]++,id):(cov_1dqamey07w().b[4][1]++,null);});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInByb21pc2lmeSIsInJlcXVpcmUiLCJqb2luIiwic3FsaXRlMyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInZlcmJvc2UiLCJkYiIsIkRhdGFiYXNlIiwiX19kaXJuYW1lIiwiZGJHZXQiLCJnZXQiLCJiaW5kIiwiZGJSdW4iLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsInJ1biIsImFwcGx5IiwiYXJndW1lbnRzIiwiZXJyIiwiZGJBbGwiLCJhbGwiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImV4aXQiLCJyb3dUb1RvZG8iLCJyb3ciLCJjb21wbGV0ZWQiLCJleHBvcnRzIiwiZmV0Y2hBbGwiLCJ0aGVuIiwicm93cyIsIm1hcCIsImZldGNoQnlDb21wbGV0ZWQiLCJjcmVhdGUiLCJ0b2RvIiwiaWQiLCJ0aXRsZSIsInVwZGF0ZSIsInNldENvbHVtbnMiLCJ2YWx1ZXMiLCJjb2x1bW4iLCJwdXNoIiwiY2hhbmdlcyIsInJlbW92ZSJdLCJtYXBwaW5ncyI6IkFBQUEsYSx3MkxBZVk7MkZBYlosS0FBTSxDQUFFQSxTQUFGLDJCQUFnQkMsT0FBTyxDQUFDLE1BQUQsQ0FBdkIsQ0FBTixDQUNBLEtBQU0sQ0FBRUMsSUFBRiwyQkFBV0QsT0FBTyxDQUFDLE1BQUQsQ0FBbEIsQ0FBTixDQUNBLEtBQU1FLENBQUFBLE9BQU8sMEJBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxRQUFaLEdBQXlCLFlBQXpCLDZCQUNaTCxPQUFPLENBQUMsU0FBRCxDQUNUO0FBRmMsOEJBR1pBLE9BQU8sQ0FBQyxTQUFELENBQVAsQ0FBbUJNLE9BQW5CLEVBSFksQ0FBSCxDQUFiLENBS0E7QUFDQSxLQUFNQyxDQUFBQSxFQUFFLDBCQUFHLEdBQUlMLENBQUFBLE9BQU8sQ0FBQ00sUUFBWixDQUFxQlAsSUFBSSxDQUFDUSxTQUFELENBQVksUUFBWixDQUF6QixDQUFILENBQVIsQ0FFQTtBQUNBLEtBQU1DLENBQUFBLEtBQUss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Q0FDQyxDQUFDLENBQUVhLE9BQUYsQ0FBRCxHQUFpQix5REFBQUEsQ0FBQUEsT0FBTyxHQUFLLENBQVosNkJBQ25CbkMsS0FBSyxDQUFFLGlDQUFGLENBQW9DNEIsRUFBcEMsQ0FBTCxDQUE2Q04sSUFBN0MsQ0FBa0RMLFNBQWxELENBRG1CLDhCQUVuQixJQUZtQixFQUVmLENBSEgsQ0FBUCxDQUtELENBaEJELEMseUJBa0JBRyxPQUFPLENBQUNnQixNQUFSLENBQWlCUixFQUFFLEVBQUkseURBQUF6QixDQUFBQSxLQUFLLENBQUUsK0JBQUYsQ0FBa0N5QixFQUFsQyxDQUFMLENBQ3BCTixJQURvQixDQUNmLENBQUMsQ0FBRWEsT0FBRixDQUFELEdBQWlCLHlEQUFBQSxDQUFBQSxPQUFPLEdBQUssQ0FBWiw2QkFBZ0JQLEVBQWhCLDhCQUFxQixJQUFyQixFQUF5QixDQUQzQixFQUM0QixDQURuRCIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgeyBwcm9taXNpZnkgfSA9IHJlcXVpcmUoJ3V0aWwnKTtcbmNvbnN0IHsgam9pbiB9ID0gcmVxdWlyZSgncGF0aCcpO1xuY29uc3Qgc3FsaXRlMyA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbidcbiAgPyByZXF1aXJlKCdzcWxpdGUzJylcbiAgLy8gcHJvZGR1Y3Rpb27nkrDlooPku6XlpJbjga/lhpfplbfjg6Ljg7zjg4njgpLliKnnlKhcbiAgOiByZXF1aXJlKCdzcWxpdGUzJykudmVyYm9zZSgpXG5cbi8vIHRvZG8tZGF0YS1zdG9yYWdlL3NxbGl0ZS9zcWxpdGXjgajjgYTjgYbjg5XjgqHjgqTjg6vjgavjg4fjg7zjgr/jg5njg7zjgrnjga7nirbmhYvjgpLkv53lrZhcbmNvbnN0IGRiID0gbmV3IHNxbGl0ZTMuRGF0YWJhc2Uoam9pbihfX2Rpcm5hbWUsICdzcWxpdGUnKSk7XG5cbi8vIOOCs+ODvOODq+ODkeODg+OCr+ODkeOCv+ODvOODs+OBruODoeOCveODg+ODieOCklByb21pc2XljJZcbmNvbnN0IGRiR2V0ID0gcHJvbWlzaWZ5KGRiLmdldC5iaW5kKGRiKSk7XG5jb25zdCBkYlJ1biA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT5cbiAgICBkYi5ydW4uYXBwbHkoZGIsIFtcbiAgICAgIC4uLmFyZ3VtZW50cyxcbiAgICAgIGZ1bmN0aW9uKGVycikge1xuICAgICAgICBlcnIgPyByZWplY3QoZXJyKSA6IHJlc29sdmUodGhpcylcbiAgICAgIH1cbiAgICBdKVxuICApXG59O1xuXG5jb25zdCBkYkFsbCA9IHByb21pc2lmeShkYi5hbGwuYmluZChkYikpO1xuXG5kYlJ1bihgQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgdG9kbyAoXG4gIGlkIFRFWFQgUFJJTUFSWSBLRVksXG4gIHRpdGxlIFRFWFQgTk9UIE5VTEwsXG4gIGNvbXBsZXRlZCBCT09MRUFOIE5PVCBOVUxMXG4pYCkuY2F0Y2goZXJyID0+IHtcbiAgLy8g44OG44O844OX44Or5L2c5oiQ44Gr5aSx5pWX44GX44Gf5aC05ZCI44Gv44Ki44OX44Oq44Kx44O844K344On44Oz44KS57WC5LqGXG4gIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgcHJvY2Vzcy5leGl0KDEpO1xufSlcblxuLy8g44OH44O844K/44OZ44O844K544Gu44OH44O844K/44KSVG9Eb+OCquODluOCuOOCp+OCr+ODiOOBq+WkieaPm+OBmeOCi1xuZnVuY3Rpb24gcm93VG9Ub2RvKHJvdykge1xuICByZXR1cm4geyAuLi5yb3csIGNvbXBsZXRlZDogISFyb3cuY29tcGxldGVkIH07XG59O1xuXG5leHBvcnRzLmZldGNoQWxsID0gKCkgPT5cbiAgZGJBbGwoYFNFTEVDVCAqIEZST00gdG9kb2ApLnRoZW4ocm93cyA9PiByb3dzLm1hcChyb3dUb1RvZG8pKTtcblxuZXhwb3J0cy5mZXRjaEJ5Q29tcGxldGVkID0gY29tcGxldGVkID0+XG4gIGRiQWxsKGBTRUxFQ1QgKiBGUk9NIHRvZG8gV0hFUkUgY29tcGxldGVkID0gP2AsIGNvbXBsZXRlZClcbiAgICAudGhlbihyb3dzID0+IHJvd3MubWFwKHJvd1RvVG9kbykpO1xuXG5leHBvcnRzLmNyZWF0ZSA9IGFzeW5jIHRvZG8gPT4ge1xuICBhd2FpdCBkYlJ1bihcbiAgICBgSU5TRVJUIElOVE8gdG9kbyBWQUxVRVMgKD8sID8sID8pYCxcbiAgICB0b2RvLmlkLFxuICAgIHRvZG8udGl0bGUsXG4gICAgdG9kby5jb21wbGV0ZWRcbiAgKVxufVxuXG5leHBvcnRzLnVwZGF0ZSA9IChpZCwgdXBkYXRlKSA9PiB7XG4gIGNvbnN0IHNldENvbHVtbnMgPSBbXTtcbiAgY29uc3QgdmFsdWVzID0gW107XG5cbiAgZm9yIChjb25zdCBjb2x1bW4gb2YgWyd0aXRsZScsICdjb21wbGV0ZWQnXSkge1xuICAgIGlmIChjb2x1bW4gaW4gdXBkYXRlKSB7XG4gICAgICBzZXRDb2x1bW5zLnB1c2goYCR7Y29sdW1ufSA9ID9gKTtcbiAgICAgIHZhbHVlcy5wdXNoKHVwZGF0ZVtjb2x1bW5dKTtcbiAgICB9XG4gIH1cbiAgdmFsdWVzLnB1c2goaWQpO1xuICByZXR1cm4gZGJSdW4oYFVQREFURSB0b2RvIFNFVCAke3NldENvbHVtbnMuam9pbigpfSBXSEVSRSBpZCA9ID9gLCB2YWx1ZXMpXG4gICAgLnRoZW4oKHsgY2hhbmdlcyB9KSA9PiBjaGFuZ2VzID09PSAxXG4gICAgICA/IGRiR2V0KGBTRUxFQ1QgKiBGUk9NIHRvZG8gV0hFUkUgaWQgPSA/YCwgaWQpLnRoZW4ocm93VG9Ub2RvKVxuICAgICAgOiBudWxsXG4gIClcbn07XG5cbmV4cG9ydHMucmVtb3ZlID0gaWQgPT4gZGJSdW4oYERFTEVURSBGUk9NIHRvZG8gV0hFUkUgaWQgPSA/YCwgaWQpXG4gIC50aGVuKCh7IGNoYW5nZXMgfSkgPT4gY2hhbmdlcyA9PT0gMSA/IGlkIDogbnVsbCk7XG4iXX0=